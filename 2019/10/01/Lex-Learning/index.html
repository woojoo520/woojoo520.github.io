<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="alternate" href="/atom.xml" title="Celery Fairy" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://woojoo520.github.io').hostname,
    root: '/',
    scheme: 'Pisces',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="LEX使用指南 reference：https://www.cnblogs.com/wp5719/p/5528896.html Lex是由美国Bell实验室M.Lesk等人用C语言开发的一种词法分析器自动生成工具，它提供一种供开发者编写词法规则（正规式等）的语言（Lex语言）以及这种语言的翻译器（这种翻译器将Lex语言编写的规则翻译成为C语言程序）。 ​     Lex是linux下的工具，本实">
<meta property="og:type" content="article">
<meta property="og:title" content="Lex Learning">
<meta property="og:url" content="https://woojoo520.github.io/2019/10/01/Lex-Learning/index.html">
<meta property="og:site_name" content="Celery Fairy">
<meta property="og:description" content="LEX使用指南 reference：https://www.cnblogs.com/wp5719/p/5528896.html Lex是由美国Bell实验室M.Lesk等人用C语言开发的一种词法分析器自动生成工具，它提供一种供开发者编写词法规则（正规式等）的语言（Lex语言）以及这种语言的翻译器（这种翻译器将Lex语言编写的规则翻译成为C语言程序）。 ​     Lex是linux下的工具，本实">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://img.blog.csdn.net/20151220202402465?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:updated_time" content="2019-10-10T09:14:27.341Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lex Learning">
<meta name="twitter:description" content="LEX使用指南 reference：https://www.cnblogs.com/wp5719/p/5528896.html Lex是由美国Bell实验室M.Lesk等人用C语言开发的一种词法分析器自动生成工具，它提供一种供开发者编写词法规则（正规式等）的语言（Lex语言）以及这种语言的翻译器（这种翻译器将Lex语言编写的规则翻译成为C语言程序）。 ​     Lex是linux下的工具，本实">
<meta name="twitter:image" content="http://img.blog.csdn.net/20151220202402465?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">

<link rel="canonical" href="https://woojoo520.github.io/2019/10/01/Lex-Learning/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Lex Learning | Celery Fairy</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Celery Fairy</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Celery's Blog</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://woojoo520.github.io/2019/10/01/Lex-Learning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.gif">
      <meta itemprop="name" content="Woojoo">
      <meta itemprop="description" content="a study blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Celery Fairy">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Lex Learning
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-01 16:29:09" itemprop="dateCreated datePublished" datetime="2019-10-01T16:29:09+08:00">2019-10-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-10-10 17:14:27" itemprop="dateModified" datetime="2019-10-10T17:14:27+08:00">2019-10-10</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/10/01/Lex-Learning/#comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/10/01/Lex-Learning/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="lex使用指南"><a class="markdownIt-Anchor" href="#lex使用指南"></a> LEX使用指南</h2>
<p><strong>reference：</strong><a href="https://www.cnblogs.com/wp5719/p/5528896.html" target="_blank" rel="noopener">https://www.cnblogs.com/wp5719/p/5528896.html</a></p>
<p>Lex是由美国Bell实验室M.Lesk等人用C语言开发的一种词法分析器自动生成工具，它提供一种供开发者编写词法规则（正规式等）的语言（Lex语言）以及这种语言的翻译器（这种翻译器将Lex语言编写的规则翻译成为C语言程序）。</p>
<p>​     Lex是linux下的工具，本实验使用的编译工具是cygwin（cygwin在windows下模拟一个linux环境）下的flex，它与lex的使用方法基本相同，只有很少的差别。</p>
<h3 id="1lex的基本原理和使用方法lex的基本工作原理为由正规式生成nfa将nfa变换成dfadfa经化简后模拟生成词法分析器"><a class="markdownIt-Anchor" href="#1lex的基本原理和使用方法lex的基本工作原理为由正规式生成nfa将nfa变换成dfadfa经化简后模拟生成词法分析器"></a> 1.Lex的基本原理和使用方法Lex的基本工作原理为：由正规式生成NFA，将NFA变换成DFA，DFA经化简后，模拟生成词法分析器。</h3>
<p>​    其中正规式由开发者使用Lex语言编写，其余部分由Lex翻译器完成.翻译器将Lex源程序翻译成一个名为lex.yy.c的C语言源文件，此文件含有两部分内容：一部分是根据正规式所构造的DFA状态转移表，另一部分是用来驱动该表的总控程序yylex()。当主程序需要从输入字符流中识别一个记号时，只需要调用一次yylex()就可以了。为了使用Lex所生成的词法分析器，我们需要将lex.yy.c程序用C编译器进行编译，并将相关支持库函数连入目标代码。Lex的使用步骤可如下图所示：</p>
<p><img src="http://img.blog.csdn.net/20151220202402465?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="img"></p>
<h3 id="2lex源程序的写法"><a class="markdownIt-Anchor" href="#2lex源程序的写法"></a> 2.lex源程序的写法</h3>
<p>Lex源程序必须按照Lex语言的规范来写，其核心是一组词法规则（正规式）。一般而言，一个Lex程序分为三部分，三部分之间以符号%%分隔。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[第一部分：定义段]</span><br><span class="line">%%</span><br><span class="line">第二部分：词法规则段</span><br><span class="line">[%%</span><br><span class="line">第三部分：辅助函数段]</span><br></pre></td></tr></table></figure>
<p>其中第一部分以及第三部分和第三部分之上的%%都可以省略（即上述方括号括起的部分可以省略）。以%开头的符号和关键字，或者是词法规则段的各个规则一般顶着行首来写，前面没有空格</p>
<p>Lex中可以有注释，注释由/* 和 */括起，但是请注意，注释的行首需要有前导空白</p>
<h4 id="1第一部分定义段的写法"><a class="markdownIt-Anchor" href="#1第一部分定义段的写法"></a> 1）第一部分定义段的写法</h4>
<p>定义段可以分为两部分：</p>
<p>第一部分以符号<code>%{</code>和<code>%}</code>包裹，里面为以C语法写的一些定义和声明：例如，文件包含，宏定义，常数定义，全局变量及外部变量定义，函数声明等等。这一部分被Lex翻译器处理后会全部拷贝到文件lex.yy.c中。注意，特殊括号<code>%{</code>和<code>%}</code>都必须顶着行首写。例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%&#123;</span><br><span class="line">#define LT 1</span><br><span class="line">int yylval;</span><br><span class="line">%&#125;</span><br></pre></td></tr></table></figure>
<p>第二部分是一组正规定义和状态定义。正规定义是为了简化后面的词法规则而给部分正规式定义了名字。每条正规定义也都要顶着行首写。例如下面这组正规定义分别定义了letter，digit和id所表示的正规式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">letter		[A-Za-z]</span><br><span class="line">digit		[0-9]</span><br><span class="line">id			&#123;letter&#125;(&#123;letter&#125;|&#123;digit&#125;)*</span><br></pre></td></tr></table></figure>
<p>注意：上面正规定义中出现的小括号表示分组，而不是被匹配的字符。而大括号括起的部分表示正规定义名</p>
<p>状态定义也叫环境定义，它定义了匹配正规式时所处的状态的名字。状态定义以<code>%s</code>开始，后跟所定义的状态的名字，注意<code>%s</code>也要顶着行首写，例如下面一行就定义了一个名为COMMENT的状态和一个名为BAD的状态，状态名之间用空白符分隔：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%d COMMENT BAD</span><br></pre></td></tr></table></figure>
<h4 id="2-第二部分词法规则段的写法"><a class="markdownIt-Anchor" href="#2-第二部分词法规则段的写法"></a> 2) 第二部分词法规则段的写法</h4>
<p>词法规则段列出的是词法分析器需要匹配的正规式，以及匹配正规式后需要进行的相关动作。其例子如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while		&#123;return (WHILE);&#125;</span><br><span class="line">do			&#123;return (DO);&#125;</span><br><span class="line">&#123;id&#125;		&#123;yylval = installID(); return (ID);&#125;</span><br></pre></td></tr></table></figure>
<p>每行都是一条规则，该规则的前一部分是正规式，需要顶着行首写，后一部分是匹配该正规式后需要进行的动作，这个动作使用C语法来写的，被包裹在<code>{}</code>之内，被Lex翻译器翻译后会被直接拷贝进lex.yy.c。正规式和语义动作之间要有空白隔开。其中用<code>{}</code>括住的正规式表示正规定义的名字</p>
<p>也可以若干个正规式匹配同一条语义动作，此时正规式之间要用<code>|</code>分隔</p>
<h4 id="3第三部分辅助函数段的写法"><a class="markdownIt-Anchor" href="#3第三部分辅助函数段的写法"></a> 3）第三部分辅助函数段的写法</h4>
<p>辅助函数段用C语言语法来写，辅助函数一般是在词法规则段中用到的函数。这一部分一般会被直接拷贝进lex.yy.c中</p>
<h4 id="4lex源程序中词法规则即正规式的相关规定"><a class="markdownIt-Anchor" href="#4lex源程序中词法规则即正规式的相关规定"></a> 4）Lex源程序中词法规则（即正规式）的相关规定</h4>
<p>详见Regulation Expression</p>
<h4 id="5lex源程序中常用到的变量及函数"><a class="markdownIt-Anchor" href="#5lex源程序中常用到的变量及函数"></a> 5）Lex源程序中常用到的变量及函数</h4>
<p><code>yyin</code>和<code>yyout</code>：这是Lex本身已定义的输入和输出文件指针。这两个变量指明了lex生成的词法分析器从哪里获得输入和输出到哪里。默认：键盘输入，屏幕输出</p>
<p><code>yytext</code>和<code>yyleng</code>：这也是lex中已定义的变量，直接用就可以了</p>
<p><code>yytext</code>：指向当前识别的词法单元（词文）的指针</p>
<p><code>yyleng</code>：当前词法单元的长度</p>
<p><code>ECHO</code>：Lex中预定义的宏，可以出现在动作中，相当于<code>fprintf(yyout, “%s”, yytext)</code>，即输出当前匹配的词法单元</p>
<p><code>yylex()</code>：词法分析驱动程序，用Lex翻译器生成的lex.yy.c内必然含有这个函数</p>
<p><code>yywrap()</code>：词法分析器遇到文件结尾时会调用<code>yywrap()</code>来决定下一步怎么做：</p>
<ul>
<li>若<code>yywrap()</code>返回0，则继续扫描</li>
<li>若返回1，则返回报告文件结尾的0标记</li>
</ul>
<p>由于词法分析器总会调用<code>yywrap</code>，因此辅助函数中最好提供<code>yywrap</code>，如果不提供，则在用C编译器编译lex.yy.c时，需要链接相应的库，库中会给出标准的<code>yywrap</code>函数（标准函数返回1）</p>
<h4 id="6词法分析器的状态环境"><a class="markdownIt-Anchor" href="#6词法分析器的状态环境"></a> 6）词法分析器的状态（环境）</h4>
<p>词法分析器在匹配正规式时，可以在不同状态（或环境下）运行。我们可以规定在不同状态下具有不同的匹配方式。每个词法分析器都至少有一个状态，这个状态叫做初始状态，可以用INITIAL或0来表示，如果还需要使用其他状态，可以在定义段用<code>%s</code>来定义。</p>
<p>在使用状态时，可以用如下方式写词法规则：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;state1, state2&gt; p0		&#123;action0;&#125;</span><br><span class="line">&lt;state1&gt; p1				&#123;action1;&#125;</span><br></pre></td></tr></table></figure>
<p>这两行词法规则表示：在状态<code>state1</code>和<code>state2</code>下，匹配正规式<code>p0</code>后执行动作<code>action0</code>，而在只有状态<code>state1</code>下，才可以匹配正规式<code>p1</code>后执行动作<code>action1</code>。如果不知名状态，默认情况下处于初始状态INITIAL。</p>
<p>要想进入某个特定状态，可以在动作中协商这样一句：<code>BEGIN state;</code>执行这个动作后，就进入状态<code>state</code></p>
<p>下面是一段处理C语言注释的例子，里面用到了状态的转换，在这个例子里，使用不同的状态，可以让词法分析器在处于注释中和处于注释外时使用不同的匹配规则</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">%s c_comment</span><br><span class="line">...</span><br><span class="line">%%</span><br><span class="line">&lt;INITIAL&gt;&quot;/*&quot; 		&#123;BEGIN c_comment;&#125;</span><br><span class="line">...</span><br><span class="line">&lt;c_comment&gt;&quot;*/&quot;		&#123;BEGIN 0;&#125;</span><br><span class="line">&lt;c_comment&gt;.		&#123;;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="7lex的匹配原则"><a class="markdownIt-Anchor" href="#7lex的匹配原则"></a> 7）Lex的匹配原则</h4>
<ul>
<li>按最长匹配原则确定被选中的单词</li>
<li>如果一个字符串能被若干正规式匹配，则先匹配排在前面的正规式</li>
</ul>
<h3 id="3lex生成的词法分析器如何使用"><a class="markdownIt-Anchor" href="#3lex生成的词法分析器如何使用"></a> 3.<strong>Lex</strong>生成的词法分析器如何使用</h3>
<p>lex常常与语法分析器的生成工具yacc（第三章会讲到）同时使用。此时，一般来说，语法分析器每次都调用一次       yylex()获取一个记号。如果想自己写一个程序使用lex生成的词法分析器，则只需要在自己的程序中按需要调用yylex()函数即可。</p>
<p>​     请注意：yylex()调用结束后，输入缓冲区并不会被重置，而是仍然停留在刚才读到的地方。并且，词法分析器当前所处的状态（%s定义的那些状态）也不会改变。</p>
<p>​    完整的Lex源程序例子请见exam1.l和exam2.l。<br>
​    <strong>exam1.l</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">/* 这是注释的形式，与C中的/*...* /注释相同。 */</span><br><span class="line">/* 第一部分是定义、声明部分。这部分内容可以为空。*/</span><br><span class="line"></span><br><span class="line">%&#123;</span><br><span class="line"></span><br><span class="line">/* 写在 %&#123;...%&#125;这对特殊括号内的内容会被直接拷贝到C文件中。</span><br><span class="line"> *</span><br><span class="line"> * 这部分通常进行一些头文件声明，变量（全局，外部）、常量</span><br><span class="line"> * 的定义，用C语法。</span><br><span class="line"> *</span><br><span class="line"> * %&#123;和%&#125;两个符号都必须位于行首 </span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">/* 下面定义了需要识别的记号名，如果和yacc联合使用，这些记号名都应该在yacc中定义 */</span><br><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#define LT					1</span><br><span class="line">#define	LE					2</span><br><span class="line">#define GT					3</span><br><span class="line">#define	GE					4</span><br><span class="line">#define	EQ					5</span><br><span class="line">#define NE					6</span><br><span class="line"></span><br><span class="line">#define WHILE				18</span><br><span class="line">#define	DO					19</span><br><span class="line">#define ID          20</span><br><span class="line">#define NUMBER      21</span><br><span class="line">#define RELOP       22</span><br><span class="line"></span><br><span class="line">#define NEWLINE     23</span><br><span class="line">#define ERRORCHAR   24</span><br><span class="line"></span><br><span class="line">int yylval;</span><br><span class="line">/* yylval 是yacc中定义的变量，用来保存记号的属性值，默认是int类型。 </span><br><span class="line"> * 在用lex实现的词法分析器中可以使用这个变量将记号的属性传递给用</span><br><span class="line"> * yacc实现的语法分析器。</span><br><span class="line"> *</span><br><span class="line"> * 注意：该变量只有在联合使用lex和yacc编写词法和语法分析器时才可在lex</span><br><span class="line"> *       中使用，此时该变量不需要定义即可使用。</span><br><span class="line"> *       单独使用lex时，编译器找不到这个变量。这里定义该变量为了“欺骗”编译器。</span><br><span class="line"> */</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">%&#125;</span><br><span class="line"></span><br><span class="line">/* 这里进行正规定义和状态定义。</span><br><span class="line"> * 下面就是正规定义，注意，正规定义和状态定义都要顶着行首写。</span><br><span class="line"> */</span><br><span class="line"> </span><br><span class="line">delim		[ \t \n]</span><br><span class="line">/* \用来表示转义，例如\t表示制表符，\n表示换行符。*/</span><br><span class="line">ws			&#123;delim&#125;+</span><br><span class="line">letter	[A-Za-z_]</span><br><span class="line">digit		[0-9]</span><br><span class="line">id			&#123;letter&#125;(&#123;letter&#125;|&#123;digit&#125;)*</span><br><span class="line">/* 注意：上面正规定义中出现的小括号表示分组，而不是被匹配的字符。</span><br><span class="line"> *       而大括号括起的部分表示正规定义名。</span><br><span class="line"> */</span><br><span class="line">number	&#123;digit&#125;+(\.&#123;digit&#125;+)?(E[+-]?&#123;digit&#125;+)?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/* %%作为lex文件三个部分的分割符，必须位于行首 */</span><br><span class="line">/* 下面这个%%不能省略 */</span><br><span class="line">%%</span><br><span class="line"></span><br><span class="line">  /* 第二部分是翻译规则部分。 */</span><br><span class="line">  /* 写在这一部分的注释要有前导空格，否则lex编译出错。*/</span><br><span class="line">  /* 翻译规则的形式是：正规式  &#123;动作&#125;</span><br><span class="line">   * 其中，正规式要顶行首写，动作要以C语法写（动作会被拷贝到yylex()函数中，），\</span><br><span class="line">   * 正规式和动作之间要用空白分割。</span><br><span class="line">   */</span><br><span class="line">  </span><br><span class="line">&#123;ws&#125;	          &#123;;/* 此时词法分析器没有动作，也不返回，而是继续分析。 */&#125;</span><br><span class="line">  /* 正规式部分用大括号扩住的表示正规定义名，例如&#123;ws&#125;。</span><br><span class="line">   * 没有扩住的直接表示正规式本身。</span><br><span class="line">   * 一些元字符没办法表示它本身，此时可以用转义字符或</span><br><span class="line">   * 用双引号括起来，例如&quot;&lt;&quot;</span><br><span class="line">   */</span><br><span class="line">while	          &#123;return (WHILE);&#125;</span><br><span class="line">do		          &#123;return (DO);&#125;</span><br><span class="line">&#123;id&#125;	          &#123;yylval = installID (); return (ID);&#125;</span><br><span class="line">&#123;number&#125;	      &#123;yylval = installNum (); return (NUMBER);&#125;</span><br><span class="line">&quot;&lt;&quot;	            &#123;yylval = LT; return (RELOP);&#125;</span><br><span class="line">&quot;&lt;=&quot;	          &#123;yylval = LE; return (RELOP);&#125;</span><br><span class="line">&quot;=&quot;	            &#123;yylval = EQ; return (RELOP);&#125;</span><br><span class="line">&quot;&lt;&gt;&quot;	          &#123;yylval = NE; return (RELOP);&#125;</span><br><span class="line">&quot;&gt;&quot;	            &#123;yylval = GT; return (RELOP);&#125;</span><br><span class="line">&quot;&gt;=&quot;	          &#123;yylval = GE; return (RELOP);&#125;</span><br><span class="line"></span><br><span class="line">.								&#123;yylval = ERRORCHAR; return ERRORCHAR;&#125;</span><br><span class="line"> /*.匹配除换行之外的任何字符，一般可作为最后一条翻译规则。*/</span><br><span class="line"> </span><br><span class="line">%%</span><br><span class="line">/* 第三部分是辅助函数部分，这部分内容以及前面的%%都可以省略 */</span><br><span class="line">/* 辅助函数可以定义“动作”中使用的一些函数。这些函数</span><br><span class="line"> * 使用C语言编写，并会直接被拷贝到lex.yy.c中。</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">int installID () &#123;</span><br><span class="line">  /* 把词法单元装入符号表并返回指针。*/</span><br><span class="line">	return ID;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int installNum () &#123;</span><br><span class="line">	/* 类似上面的过程，但词法单元不是标识符而是数 */</span><br><span class="line">  return NUMBER;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/* yywrap这个辅助函数是词法分析器遇到输入文件结尾时会调用的，用来决定下一步怎么做：</span><br><span class="line"> * 若yywrap返回0，则继续扫描；返回1，则词法分析器返回报告文件已结束的0。</span><br><span class="line"> * lex库中的标准yywrap程序就是返回1，你也可以定义自己的yywrap。</span><br><span class="line"> */</span><br><span class="line">int yywrap ()&#123;</span><br><span class="line">  return 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void writeout(int c)&#123;</span><br><span class="line">  switch(c)&#123;</span><br><span class="line">  	case ERRORCHAR: fprintf(yyout, &quot;(ERRORCHAR, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">  	case RELOP: fprintf(yyout, &quot;(RELOP, \&quot;%s\&quot;) &quot;, yytext);break;  	  </span><br><span class="line">    case WHILE: fprintf(yyout, &quot;(WHILE, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">    case DO: fprintf(yyout, &quot;(DO, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">    case NUMBER: fprintf(yyout, &quot;(NUM, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">    case ID: fprintf(yyout, &quot;(ID, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">    case NEWLINE: fprintf(yyout, &quot;\n&quot;);break;</span><br><span class="line">    default:break;</span><br><span class="line">  &#125;</span><br><span class="line">  return;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 辅助函数里可以使用yytext和yyleng这些外部定义的变量。</span><br><span class="line"> * yytext指向输入缓冲区当前词法单元(lexeme)的第一个字符，</span><br><span class="line"> * yyleng给出该词法单元的长度		*/</span><br><span class="line"></span><br><span class="line">/* 如果你的词法分析器并不是作为语法分析器的子程序，</span><br><span class="line"> * 而是有自己的输入输出，你可以在这里定义你的词法</span><br><span class="line"> * 分析器的main函数，main函数里可以调用yylex()</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">int main (int argc, char ** argv)&#123;</span><br><span class="line">	int c,j=0;</span><br><span class="line">	if (argc&gt;=2)&#123;</span><br><span class="line">	  if ((yyin = fopen(argv[1], &quot;r&quot;)) == NULL)&#123;</span><br><span class="line">	    printf(&quot;Can&apos;t open file %s\n&quot;, argv[1]);</span><br><span class="line">	    return 1;</span><br><span class="line">	  &#125;</span><br><span class="line">	  if (argc&gt;=3)&#123;</span><br><span class="line">	    yyout=fopen(argv[2], &quot;w&quot;);</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	/* yyin和yyout是lex中定义的输入输出文件指针，它们指明了</span><br><span class="line">	 * lex生成的词法分析器从哪里获得输入和输出到哪里。</span><br><span class="line">	 * 默认：键盘输入，屏幕输出。 </span><br><span class="line">	 */</span><br><span class="line">	while (c = yylex())&#123;</span><br><span class="line">		writeout(c);</span><br><span class="line">		j++;</span><br><span class="line">		if (j%5 == 0) writeout(NEWLINE);</span><br><span class="line">	&#125;</span><br><span class="line">	if(argc&gt;=2)&#123;</span><br><span class="line">	  fclose(yyin);</span><br><span class="line">	  if (argc&gt;=3) fclose(yyout);</span><br><span class="line">	&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>exam2.l</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">/* 把注释去掉 */</span><br><span class="line"></span><br><span class="line">%&#123;</span><br><span class="line"></span><br><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#define LT					1</span><br><span class="line">#define	LE					2</span><br><span class="line">#define GT					3</span><br><span class="line">#define	GE					4</span><br><span class="line">#define	EQ					5</span><br><span class="line">#define NE					6</span><br><span class="line">#define LLK                                     7</span><br><span class="line">#define RLK                                     8</span><br><span class="line">#define LBK                                     9</span><br><span class="line">#define RBK                                     10</span><br><span class="line">#define IF                               11</span><br><span class="line">#define ELSE                             12</span><br><span class="line">#define EQU                              13</span><br><span class="line">#define SEM                              14</span><br><span class="line"></span><br><span class="line">#define WHILE				18</span><br><span class="line">#define	DO					19</span><br><span class="line">#define ID          20</span><br><span class="line">#define NUMBER      21</span><br><span class="line">#define RELOP       22</span><br><span class="line"></span><br><span class="line">#define NEWLINE     23</span><br><span class="line">#define ERRORCHAR   24</span><br><span class="line">#define ADD                       25</span><br><span class="line">#define  DEC                         26</span><br><span class="line">#define  MUL                         27</span><br><span class="line">#define  DIV                        28</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">%&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">delim		[ \t \n]</span><br><span class="line">ws			&#123;delim&#125;+</span><br><span class="line">letter	[A-Za-z_]</span><br><span class="line">digit		[0-9]</span><br><span class="line">id			&#123;letter&#125;(&#123;letter&#125;|&#123;digit&#125;)*</span><br><span class="line">number	&#123;digit&#125;+(\.&#123;digit&#125;+)?(E[+-]?&#123;digit&#125;+)?</span><br><span class="line"></span><br><span class="line">/* 状态（或条件）定义可以定义在这里 </span><br><span class="line"> * INITIAL是一个默认的状态，不需要定义</span><br><span class="line"> */</span><br><span class="line">%s COMMENT</span><br><span class="line">%s COMMENT2</span><br><span class="line">%%</span><br><span class="line"></span><br><span class="line">&lt;INITIAL&gt;&quot;/*&quot;						&#123;BEGIN COMMENT;&#125;</span><br><span class="line">&lt;COMMENT&gt;&quot;*/&quot;						&#123;BEGIN INITIAL;&#125;</span><br><span class="line">&lt;COMMENT&gt;.|\n						&#123;;&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;//&quot;						&#123;BEGIN COMMENT2;&#125;</span><br><span class="line">&lt;COMMENT2&gt;\n					&#123;BEGIN INITIAL;&#125;</span><br><span class="line">&lt;COMMENT2&gt;.					&#123;;&#125;</span><br><span class="line"></span><br><span class="line"> /* ECHO是一个宏，相当于 fprintf(yyout, &quot;%s&quot;, yytext)*/</span><br><span class="line"></span><br><span class="line">&lt;INITIAL&gt;&#123;ws&#125;	          &#123;;&#125;</span><br><span class="line">&lt;INITIAL&gt;while					&#123;return (WHILE);&#125;</span><br><span class="line">&lt;INITIAL&gt;do		          &#123;return (DO);&#125;</span><br><span class="line">&lt;INITIAL&gt;if		          &#123;return (IF);&#125;</span><br><span class="line">&lt;INITIAL&gt;else		          &#123;return (ELSE);&#125;</span><br><span class="line">&lt;INITIAL&gt;&#123;id&#125;	          &#123;return (ID);&#125;</span><br><span class="line">&lt;INITIAL&gt;&#123;number&#125;	      &#123;return (NUMBER);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;&lt;&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;&lt;=&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;=&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;!=&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;&gt;&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;&gt;=&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;(&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;)&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;&#123;&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;&#125;&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;+&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;-&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;*&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;/&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line">&lt;INITIAL&gt;&quot;;&quot;	          &#123;return (RELOP);&#125;</span><br><span class="line"></span><br><span class="line">&lt;INITIAL&gt;.							&#123;return ERRORCHAR;&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">%%</span><br><span class="line"></span><br><span class="line">int yywrap ()&#123;</span><br><span class="line">  return 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void writeout(int c)&#123;</span><br><span class="line">  switch(c)&#123;</span><br><span class="line">  	case ERRORCHAR: fprintf(yyout, &quot;(ERRORCHAR, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">  	case RELOP: fprintf(yyout, &quot;(RELOP, \&quot;%s\&quot;) &quot;, yytext);break;  	  </span><br><span class="line">    case WHILE: fprintf(yyout, &quot;(WHILE, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">    case DO: fprintf(yyout, &quot;(DO, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">    case IF: fprintf(yyout, &quot;(IF, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">   case ELSE: fprintf(yyout, &quot;(ELSE, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">    case NUMBER: fprintf(yyout, &quot;(NUM, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">    case ID: fprintf(yyout, &quot;(ID, \&quot;%s\&quot;) &quot;, yytext);break;</span><br><span class="line">    case NEWLINE: fprintf(yyout, &quot;\n&quot;);break;</span><br><span class="line">    default:break;</span><br><span class="line">  &#125;</span><br><span class="line">  return;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main (int argc, char ** argv)&#123;</span><br><span class="line">	int c,j=0;</span><br><span class="line">	if (argc&gt;=2)&#123;</span><br><span class="line">	  if ((yyin = fopen(argv[1], &quot;r&quot;)) == NULL)&#123;</span><br><span class="line">	    printf(&quot;Can&apos;t open file %s\n&quot;, argv[1]);</span><br><span class="line">	    return 1;</span><br><span class="line">	  &#125;</span><br><span class="line">	  if (argc&gt;=3)&#123;</span><br><span class="line">	    yyout=fopen(argv[2], &quot;w&quot;);</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	while (c = yylex())&#123;</span><br><span class="line">		writeout(c);</span><br><span class="line">		j++;</span><br><span class="line">		if (j%5 == 0) writeout(NEWLINE);</span><br><span class="line">	&#125;</span><br><span class="line">	if(argc&gt;=2)&#123;</span><br><span class="line">	  fclose(yyin);</span><br><span class="line">	  if (argc&gt;=3) fclose(yyout);</span><br><span class="line">	&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-编译lex文件"><a class="markdownIt-Anchor" href="#4-编译lex文件"></a> 4. 编译Lex文件</h3>
<p>先将<code>win_flex.exe</code>加入到环境变量，然后运行：</p>
<p><code>win_flex.exe --wincompat a.l　　　　　　// wincompat参数不能省</code></p>
<p>然后运行</p>
<p><code>g++ .\lex.yy.c</code></p>
<p>然后生成了一个a.exe，并运行</p>
<p><code>.\a.exe hello.cpp out.txt</code></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/10/01/LeetCode-Day43/" rel="prev" title="LeetCode-Day43">
      <i class="fa fa-chevron-left"></i> LeetCode-Day43
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/10/06/先验分布-后验分布-似然估计/" rel="next" title="先验分布/后验分布/似然估计">
      先验分布/后验分布/似然估计 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="comments"></div>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#lex使用指南"><span class="nav-number">1.</span> <span class="nav-text"> LEX使用指南</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1lex的基本原理和使用方法lex的基本工作原理为由正规式生成nfa将nfa变换成dfadfa经化简后模拟生成词法分析器"><span class="nav-number">1.1.</span> <span class="nav-text"> 1.Lex的基本原理和使用方法Lex的基本工作原理为：由正规式生成NFA，将NFA变换成DFA，DFA经化简后，模拟生成词法分析器。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2lex源程序的写法"><span class="nav-number">1.2.</span> <span class="nav-text"> 2.lex源程序的写法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1第一部分定义段的写法"><span class="nav-number">1.2.1.</span> <span class="nav-text"> 1）第一部分定义段的写法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-第二部分词法规则段的写法"><span class="nav-number">1.2.2.</span> <span class="nav-text"> 2) 第二部分词法规则段的写法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3第三部分辅助函数段的写法"><span class="nav-number">1.2.3.</span> <span class="nav-text"> 3）第三部分辅助函数段的写法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4lex源程序中词法规则即正规式的相关规定"><span class="nav-number">1.2.4.</span> <span class="nav-text"> 4）Lex源程序中词法规则（即正规式）的相关规定</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5lex源程序中常用到的变量及函数"><span class="nav-number">1.2.5.</span> <span class="nav-text"> 5）Lex源程序中常用到的变量及函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6词法分析器的状态环境"><span class="nav-number">1.2.6.</span> <span class="nav-text"> 6）词法分析器的状态（环境）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7lex的匹配原则"><span class="nav-number">1.2.7.</span> <span class="nav-text"> 7）Lex的匹配原则</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3lex生成的词法分析器如何使用"><span class="nav-number">1.3.</span> <span class="nav-text"> 3.Lex生成的词法分析器如何使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-编译lex文件"><span class="nav-number">1.4.</span> <span class="nav-text"> 4. 编译Lex文件</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Woojoo"
      src="/images/logo.gif">
  <p class="site-author-name" itemprop="name">Woojoo</p>
  <div class="site-description" itemprop="description">a study blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">144</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Woojoo</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://pisces.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.5.0
  </div>

        








        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  
















  

  

  


<script>
NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'aKRj8pzPJm0LdONJb0Ci0U5L-gzGzoHsz',
    appKey: 'vA8nbcq2HgWrqovGq6LwXRG1',
    placeholder: "Just go go",
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: '' || 'zh-cn',
    path: location.pathname,
    recordIP: false,
    serverURLs: ''
  });
}, window.Valine);
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
